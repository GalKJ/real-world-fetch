<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Real world fetch</title>
  </head>
  <body>
    <form
      id="form"
      action="https://learn-forms.netlify.com/submit/part3"
      method="GET"
    >
      <fieldset>
        <legend>Contact Us</legend>

        <label for="name">Name</label>
        <input id="name" name="name" type="text" required />

        <label for="email">Email</label>
        <input id="email" name="email" type="email" required />

        <button type="submit">Submit</button>
      </fieldset>
    </form>

    <script>
      // HTTP errors. Challenge One

      // fetch('https://echo.oliverjam.workers.dev/status/404')
      //   .then(console.log)
      //   .catch(console.error);

      // Challenge Two.

      // fetch('https://echo.oliverjam.workers.dev/status/404')
      //   .then((response) => {
      //     if (!response.ok) {
      //       throw new Error(`bad error baby ${response.status}`);
      //     }
      //   })
      //   .catch(console.error);

      // Submitting data. Challenge One

      // fetch('https://echo.oliverjam.workers.dev/json', {
      //   method: 'POST',
      //   headers: {
      //     'Content-Type': 'application/json',
      //   },
      //   body: JSON.stringify({
      //     name: 'The Rabbit',
      //   }),
      // })
      //   .then((response) => {
      //     return response.json();
      //   })
      //   .then((data) => console.log(data))
      //   .catch(console.error);

      // User Input

      // const myForm = document.querySelector('form');

      // myForm.addEventListener('submit', (event) => {
      //   event.preventDefault();

      //   const name = document.querySelector('#name').value;
      //   const email = document.querySelector('#email').value;

      //   fetch('https://echo.oliverjam.workers.dev/json', {
      //     method: 'POST',
      //     headers: {
      //       'Content-Type': 'application/json',
      //     },
      //     body: JSON.stringify({
      //       name: name,
      //       email: email,
      //     }),
      //   })
      //     .then((response) => {
      //       return response.json();
      //     })
      //     .then((data) => console.log(data))
      //     .catch(console.error);
      // });

      // New Form Data

      const myForm = document.querySelector('form');

      myForm.addEventListener('submit', (event) => {
        event.preventDefault();

        const name = document.querySelector('#name').value;
        const email = document.querySelector('#email').value;

        const newForm = new FormData(myForm);
        const data = Object.fromEntries(newForm);

        fetch('https://echo.oliverjam.workers.dev/json', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            data,
          }),
        })
          .then((response) => {
            return response.json();
          })
          .then((data) => console.log(data))
          .catch(console.error);
      });
    </script>
  </body>
</html>
